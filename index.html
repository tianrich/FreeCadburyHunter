<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Cadbury Secret Santa - Operations Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0e27;font-family:'Inter',sans-serif;color:#e4e4e7;min-height:100vh;line-height:1.6}
.topnav{background:#111827;border-bottom:1px solid #1f2937;padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:70px;position:sticky;top:0;z-index:100;box-shadow:0 4px 6px -1px rgba(0,0,0,0.3)}
.logo{display:flex;align-items:center;gap:12px;font-size:1.25rem;font-weight:700;color:#f59e0b}
.logo i{font-size:1.75rem}
.nav-actions{display:flex;gap:12px;align-items:center}
.nav-btn{background:transparent;border:1px solid #374151;color:#9ca3af;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:.875rem;font-weight:500;transition:all .2s;display:flex;align-items:center;gap:6px}
.nav-btn:hover{background:#1f2937;border-color:#4b5563;color:#e4e4e7}
.nav-btn.primary{background:#f59e0b;border-color:#f59e0b;color:#111827}
.nav-btn.primary:hover{background:#d97706;border-color:#d97706}
.container{max-width:1800px;margin:0 auto;padding:30px 40px}
.stats-bar{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-bottom:30px}
.stat-card{background:#111827;border:1px solid #1f2937;border-radius:12px;padding:24px;transition:all .2s}
.stat-card:hover{border-color:#374151;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.4)}
.stat-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.stat-label{font-size:.875rem;color:#9ca3af;font-weight:500;text-transform:uppercase;letter-spacing:.5px}
.stat-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.25rem}
.stat-icon.blue{background:rgba(59,130,246,0.1);color:#3b82f6}
.stat-icon.amber{background:rgba(245,158,11,0.1);color:#f59e0b}
.stat-icon.emerald{background:rgba(16,185,129,0.1);color:#10b981}
.stat-icon.red{background:rgba(239,68,68,0.1);color:#ef4444}
.stat-value{font-size:2rem;font-weight:700;color:#f9fafb}
.status-banner{background:linear-gradient(135deg,#111827 0%,#1f2937 100%);border:1px solid #374151;border-radius:12px;padding:32px;margin-bottom:30px;display:flex;align-items:center;justify-content:space-between}
.status-content{display:flex;align-items:center;gap:20px}
.status-indicator{width:12px;height:12px;border-radius:50%;background:#10b981;animation:pulse-dot 2s infinite}
@keyframes pulse-dot{0%,100%{opacity:1}50%{opacity:.5}}
.status-text h2{font-size:1.5rem;font-weight:600;margin-bottom:4px}
.status-text p{color:#9ca3af;font-size:.875rem}
.main-grid{display:grid;grid-template-columns:2fr 1fr;gap:24px;margin-bottom:24px}
.panel{background:#111827;border:1px solid #1f2937;border-radius:12px;overflow:hidden}
.panel-header{padding:20px 24px;border-bottom:1px solid #1f2937;display:flex;justify-content:space-between;align-items:center}
.panel-title{font-size:1.125rem;font-weight:600;display:flex;align-items:center;gap:10px}
.panel-title i{color:#f59e0b}
.panel-body{padding:0;max-height:600px;overflow-y:auto}
.panel-body::-webkit-scrollbar{width:8px}
.panel-body::-webkit-scrollbar-track{background:#111827}
.panel-body::-webkit-scrollbar-thumb{background:#374151;border-radius:4px}
.log-entry{padding:16px 24px;border-bottom:1px solid #1f2937;transition:background .2s;animation:fadeIn .3s ease}
@keyframes fadeIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}
.log-entry:hover{background:#1f2937}
.log-entry-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.log-status{display:flex;align-items:center;gap:8px;font-weight:600;font-size:.875rem}
.log-status.success{color:#10b981}
.log-status.error{color:#ef4444}
.log-status.pending{color:#f59e0b}
.log-status.info{color:#6b7280}
.log-time{font-size:.75rem;color:#6b7280}
.log-message{font-size:.875rem;color:#d1d5db;line-height:1.5}
.log-link{color:#f59e0b;text-decoration:none;font-weight:500}
.log-link:hover{text-decoration:underline}
.toast{position:fixed;top:90px;right:20px;background:#111827;border:1px solid #10b981;border-radius:8px;padding:16px 20px;min-width:300px;box-shadow:0 10px 25px rgba(0,0,0,0.5);z-index:1000;animation:slideIn .3s ease;display:none}
@keyframes slideIn{from{transform:translateX(400px)}to{transform:translateX(0)}}
.toast-header{display:flex;align-items:center;gap:10px;font-weight:600;margin-bottom:6px;color:#10b981}
.toast-message{font-size:.875rem;color:#9ca3af}
@media(max-width:1200px){.main-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<nav class="topnav">
  <div class="logo"><i class="fas fa-gift"></i><span>Cadbury Secret Santa Ops</span></div>
  <div class="nav-actions"><button class="nav-btn primary" onclick="testConfetti()">Test Alert</button></div>
</nav>
<div class="container">
  <div class="stats-bar">
    <div class="stat-card"><div class="stat-header"><span class="stat-label">Total Scans</span><div class="stat-icon blue">Search</div></div><div class="stat-value" id="checked">0</div></div>
    <div class="stat-card"><div class="stat-header"><span class="stat-label">Chocolate Found</span><div class="stat-icon emerald">Trophy</div></div><div class="stat-value" id="success">0</div></div>
    <div class="stat-card"><div class="stat-header"><span class="stat-label">Uptime</span><div class="stat-icon amber">Clock</div></div><div class="stat-value" id="uptime">0:00</div></div>
    <div class="stat-card"><div class="stat-header"><span class="stat-label">Last Win</span><div class="stat-icon red">Star</div></div><div class="stat-value" id="last">Never</div></div>
  </div>
  <div class="status-banner">
    <div class="status-content">
      <div class="status-indicator"></div>
      <div class="status-text"><h2 id="statusText">System Active - Monitoring 20 Links</h2><p>Real-time surveillance across all Secret Santa endpoints</p></div>
    </div>
  </div>
  <div class="main-grid">
    <div class="panel">
      <div class="panel-header"><div class="panel-title">Activity Stream</div></div>
      <div class="panel-body" id="activityLog">
        <div class="log-entry">
          <div class="log-entry-header"><div class="log-status info">System Online</div><div class="log-time">Just now</div></div>
          <div class="log-message">Cadbury Secret Santa scanner is now active</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="toast" id="toast"><div class="toast-header">Success</div><div class="toast-message" id="toastMessage">New chocolate captured!</div></div>
<audio id="alertSound" src="https://cdn.freesound.org/previews/612/612558_5674468-lq.mp3"></audio>
<script>
let successCount=0,checkedCount=0;const startTime=Date.now();
setInterval(()=>{let e=Math.floor((Date.now()-startTime)/1000),t=String(Math.floor(e/60)).padStart(2,"0"),a=String(e%60).padStart(2,"0");document.getElementById("uptime").textContent=`${t}:${a}`},1000);
function showToast(e,t){document.getElementById("toastTitle").textContent=e,document.getElementById("toastMessage").textContent=t;const a=document.getElementById("toast");a.style.display="block",setTimeout(()=>a.style.display="none",5000)}
function fireConfetti(){confetti({particleCount:150,spread:80,origin:{y:.6},colors:["#f59e0b","#10b981","#ff69b4"]}),document.getElementById("alertSound").play().catch(()=>{})}
function testConfetti(){fireConfetti(),showToast("Test Alert","Confetti & sound working!")}
function addLog(e,t,a,n=null){const o=document.getElementById("activityLog"),i=document.createElement("div");i.className="log-entry";const l={SUCCESS:"check-circle success",missed:"clock pending",error:"exclamation-triangle error",already_opened:"lock info"},s=l[e]||"info-circle info",r=n?`<a href="${n}" target="_blank" class="log-link">Open Link</a>`:"";i.innerHTML=`<div class="log-entry-header"><div class="log-status ${s.split(" ")[1]}">CHOCOLATE FOUND</div><div class="log-time">${t}</div></div><div class="log-message">${a} ${r}</div>`,o.insertBefore(i,o.firstChild),o.children.length>100&&o.removeChild(o.lastChild)}
const es=new EventSource("/events");
es.onmessage=e=>{const t=JSON.parse(e.data);t.forEach(e=>{checkedCount++,document.getElementById("checked").textContent=checkedCount,e.status==="SUCCESS"?(successCount++,document.getElementById("success").textContent=successCount,document.getElementById("last").textContent=e.time,document.getElementById("statusText").textContent="CHOCOLATE SECURED!",addLog("SUCCESS",e.time,"New active link captured!",e.final),fireConfetti(),showToast("FREE CHOCOLATE!","Click the link in the log now!"),setTimeout(()=>document.getElementById("statusText").textContent="System Active - Monitoring 20 Links",8000)):e.status==="missed"?addLog("missed",e.time,"Link expired or claimed"):e.status==="error"?addLog("error",e.time,"Network error"):addLog("already_opened",e.time,"Already captured")})};
es.onerror=()=>{addLog("error",new Date().toLocaleTimeString(),"Connection lost - reconnecting...")}
</script>
</body>
</html>
